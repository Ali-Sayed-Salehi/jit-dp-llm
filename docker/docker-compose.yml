services:
  llama-train-environment:
    build:
      context: ..
      dockerfile: docker/Dockerfile.llama-train-environment
      args:
        UID: ${UID}
        GID: ${GID}
        USERNAME: app
    image: llama-train-environment:latest
    working_dir: /workspace
    environment:
      - HOME=/workspace
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility
    volumes:
      - ../:/workspace
    runtime: nvidia
    command: ["./docker/run_with_logs.sh"]
